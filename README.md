# OTP Verification Service

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞—â–∏—Ç—É –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –∫–æ–¥–æ–≤ (OTP), –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º:

- Email
- SMS
- Telegram
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª

–°–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ Java —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Spring Boot**, **JDBC**, **PostgreSQL**, –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ —Ä–æ–ª—è–º (USER/ADMIN) —á–µ—Ä–µ–∑ **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é**.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 17+
- PostgreSQL 17
- Gradle
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) SMPPSim –¥–ª—è SMS
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Telegram Bot + chat_id

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `otp_service` –≤ PostgreSQL
2. –ü—Ä–æ–ª–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ `resources/sql/create.sql`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `application.yml` —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
4. –î–æ–±–∞–≤—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤:
    - `email.properties`
    - `sms.properties`
    - `telegram.properties`

5. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
./gradlew bootRun
```

---

## –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –®–∞–≥ 1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
POST /api/auth/register
{
  "username": "user1",
  "password": "123456",
  "role": "USER"
}
```

–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
- –ú–æ–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ**

---

### –®–∞–≥ 2. –í–æ–π–¥–∏—Ç–µ –∏ –ø–æ–ª—É—á–∏—Ç–µ JWT-—Ç–æ–∫–µ–Ω

```http
POST /api/auth/login
{
  "username": "user1",
  "password": "123456"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "token": "Bearer eyJhbGciOiJIUzI1NiIs..."
}
```

---

### –®–∞–≥ 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è OTP

```http
POST /api/user/otp/generate
Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>

{
  "operationId": "confirm-order-42",
  "channel": "email", // –∏–ª–∏ sms, telegram, file
  "destination": "user@example.com"
}
```

---

### –®–∞–≥ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

```http
POST /api/user/otp/validate
Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>

{
  "operationId": "confirm-order-42",
  "code": "123456"
}
```

---

## –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ (–¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ ADMIN)

### –ò–∑–º–µ–Ω–∏—Ç—å TTL –∏ –¥–ª–∏–Ω—É –∫–æ–¥–∞

```http
PUT /api/admin/config
Authorization: Bearer <—Ç–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞>

{
  "length": 6,
  "ttlSeconds": 180
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```http
GET /api/admin/users
Authorization: Bearer <—Ç–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞>
```

### –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
DELETE /api/admin/users/{username}
Authorization: Bearer <—Ç–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞>
```

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–Ω
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è OTP-–∫–æ–¥–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4-—Ö –∫–∞–Ω–∞–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–æ–≤
- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

---

## üßë‚Äçüíª –ê–≤—Ç–æ—Ä

Evgenii Isupov ‚Äî Java-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫